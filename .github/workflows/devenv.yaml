name: devenv

on:
  push:
    branches:
      # Local policy requires staging checks before pushing to main.
      # We also don't run jobs on main.
      - pkg-staging
    paths:
      - pkgs/devenv.nix
      - flake.lock

jobs:
  devenv:
    uses: ./.github/workflows/build-nix.yaml
    with:
      build_target: ".#devenv"
    secrets:
      cachix_auth_token: "${{ secrets.CACHIX_AUTH_TOKEN }}"
